"use strict";{const e=django.jQuery;e.fn.formset=function(t){const n=e.extend({},e.fn.formset.defaults,t),s=e(this),i=s.parent(),a=function(t,n,s){const i=new RegExp("("+n+"-(\\d+|__prefix__))"),a=n+"-"+s;e(t).prop("for")&&e(t).prop("for",e(t).prop("for").replace(i,a)),t.id&&(t.id=t.id.replace(i,a)),t.name&&(t.name=t.name.replace(i,a))},l=e("#id_"+n.prefix+"-TOTAL_FORMS").prop("autocomplete","off");let d=parseInt(l.val(),10);const o=e("#id_"+n.prefix+"-MAX_NUM_FORMS").prop("autocomplete","off"),r=e("#id_"+n.prefix+"-MIN_NUM_FORMS").prop("autocomplete","off");let f;const c=function(){if(null===f)if("TR"===s.prop("tagName")){const e=s.eq(-1).children().length;i.append('<tr class="'+n.addCssClass+'"><td colspan="'+e+'"><a href="#">'+n.addText+"</a></tr>"),f=i.find("tr:last a")}else s.filter(":last").after('<div class="'+n.addCssClass+'"><a href="#">'+n.addText+"</a></div>"),f=s.filter(":last").next().find("a");f.on("click",p)},p=function(t){t.preventDefault();const s=e("#"+n.prefix+"-empty"),i=s.clone(!0);i.removeClass(n.emptyCssClass).addClass(n.formCssClass).attr("id",n.prefix+"-"+d),u(i),i.find("*").each((function(){a(this,n.prefix,l.val())})),i.insertBefore(e(s)),e(l).val(parseInt(l.val(),10)+1),d+=1,""!==o.val()&&o.val()-l.val()<=0&&f.parent().hide(),h(i.closest(".inline-group")),n.added&&n.added(i),e(document).trigger("formset:added",[i,n.prefix])},u=function(e){e.is("tr")?e.children(":last").append('<div><a class="'+n.deleteCssClass+'" href="#">'+n.deleteText+"</a></div>"):e.is("ul")||e.is("ol")?e.append('<li><a class="'+n.deleteCssClass+'" href="#">'+n.deleteText+"</a></li>"):e.children(":first").append('<span><a class="'+n.deleteCssClass+'" href="#">'+n.deleteText+"</a></span>"),e.find("a."+n.deleteCssClass).on("click",m.bind(this))},m=function(t){t.preventDefault();const s=e(t.target),i=s.closest("."+n.formCssClass),l=i.closest(".inline-group"),r=i.prev();r.length&&r.hasClass("row-form-errors")&&r.remove(),i.remove(),d-=1,n.removed&&n.removed(i),e(document).trigger("formset:removed",[i,n.prefix]);const c=e("."+n.formCssClass);let p,u;e("#id_"+n.prefix+"-TOTAL_FORMS").val(c.length),(""===o.val()||o.val()-c.length>0)&&f.parent().show(),h(l);const m=function(){a(this,n.prefix,p)};for(p=0,u=c.length;p<u;p++)a(e(c).get(p),n.prefix,p),e(c.get(p)).find("*").each(m)},h=function(e){""!==r.val()&&r.val()-l.val()>=0?e.find(".inline-deletelink").hide():e.find(".inline-deletelink").show()};s.each((function(t){e(this).not("."+n.emptyCssClass).addClass(n.formCssClass)})),s.filter("."+n.formCssClass+":not(.has_original):not(."+n.emptyCssClass+")").each((function(){u(e(this))})),h(s),f=n.addButton,c();const C=""===o.val()||o.val()-l.val()>0;return s.length&&C?f.parent().show():f.parent().hide(),this},e.fn.formset.defaults={prefix:"form",addText:"add another",deleteText:"remove",addCssClass:"add-row",deleteCssClass:"delete-row",emptyCssClass:"empty-row",formCssClass:"dynamic-form",added:null,removed:null,addButton:null},e.fn.tabularFormset=function(t,n){const s=e(this),i=function(){"undefined"!==typeof DateTimeShortcuts&&(e(".datetimeshortcuts").remove(),DateTimeShortcuts.init())},a=function(){"undefined"!==typeof SelectFilter&&(e(".selectfilter").each((function(e,t){const n=t.name.split("-");SelectFilter.init(t.id,n[n.length-1],!1)})),e(".selectfilterstacked").each((function(e,t){const n=t.name.split("-");SelectFilter.init(t.id,n[n.length-1],!0)})))},l=function(t){t.find(".prepopulated_field").each((function(){const n=e(this),s=n.find("input, select, textarea"),i=s.data("dependency_list")||[],a=[];e.each(i,(function(e,n){a.push("#"+t.find(".field-"+n).find("input, select, textarea").attr("id"))})),a.length&&s.prepopulate(a,s.attr("maxlength"))}))};return s.formset({prefix:n.prefix,addText:n.addText,formCssClass:"dynamic-"+n.prefix,deleteCssClass:"inline-deletelink",deleteText:n.deleteText,emptyCssClass:"empty-form",added:function(e){l(e),i(),a()},addButton:n.addButton}),s},e.fn.stackedFormset=function(t,n){const s=e(this),i=function(n){e(t).find(".inline_label").each((function(t){const n=t+1;e(this).html(e(this).html().replace(/(#\d+)/g,"#"+n))}))},a=function(){"undefined"!==typeof DateTimeShortcuts&&(e(".datetimeshortcuts").remove(),DateTimeShortcuts.init())},l=function(){"undefined"!==typeof SelectFilter&&(e(".selectfilter").each((function(e,t){const n=t.name.split("-");SelectFilter.init(t.id,n[n.length-1],!1)})),e(".selectfilterstacked").each((function(e,t){const n=t.name.split("-");SelectFilter.init(t.id,n[n.length-1],!0)})))},d=function(t){t.find(".prepopulated_field").each((function(){const n=e(this),s=n.find("input, select, textarea"),i=s.data("dependency_list")||[],a=[];e.each(i,(function(e,n){a.push("#"+t.find(".form-row .field-"+n).find("input, select, textarea").attr("id"))})),a.length&&s.prepopulate(a,s.attr("maxlength"))}))};return s.formset({prefix:n.prefix,addText:n.addText,formCssClass:"dynamic-"+n.prefix,deleteCssClass:"inline-deletelink",deleteText:n.deleteText,emptyCssClass:"empty-form",removed:i,added:function(e){d(e),a(),l(),i(e)},addButton:n.addButton}),s},e(document).ready((function(){e(".js-inline-admin-formset").each((function(){const t=e(this).data(),n=t.inlineFormset;let s;switch(t.inlineType){case"stacked":s=n.name+"-group .inline-related",e(s).stackedFormset(s,n.options);break;case"tabular":s=n.name+"-group .tabular.inline-related tbody:first > tr.form-row",e(s).tabularFormset(s,n.options);break}}))}))}