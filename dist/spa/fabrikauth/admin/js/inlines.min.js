"use strict";{const e=django.jQuery;e.fn.formset=function(t){const n=e.extend({},e.fn.formset.defaults,t),s=e(this),a=s.parent(),i=function(t,n,s){const a=new RegExp("("+n+"-(\\d+|__prefix__))");n=n+"-"+s,e(t).prop("for")&&e(t).prop("for",e(t).prop("for").replace(a,n)),t.id&&(t.id=t.id.replace(a,n)),t.name&&(t.name=t.name.replace(a,n))},l=e("#id_"+n.prefix+"-TOTAL_FORMS").prop("autocomplete","off");let d=parseInt(l.val(),10);const r=e("#id_"+n.prefix+"-MAX_NUM_FORMS").prop("autocomplete","off"),o=e("#id_"+n.prefix+"-MIN_NUM_FORMS").prop("autocomplete","off");let f;const c=function(t){t.preventDefault(),t=e("#"+n.prefix+"-empty");const s=t.clone(!0);s.removeClass(n.emptyCssClass).addClass(n.formCssClass).attr("id",n.prefix+"-"+d),p(s),s.find("*").each((function(){i(this,n.prefix,l.val())})),s.insertBefore(e(t)),e(l).val(parseInt(l.val(),10)+1),d+=1,""!==r.val()&&0>=r.val()-l.val()&&f.parent().hide(),m(s.closest(".inline-group")),n.added&&n.added(s),e(document).trigger("formset:added",[s,n.prefix])},p=function(e){e.is("tr")?e.children(":last").append('<div><a class="'+n.deleteCssClass+'" href="#">'+n.deleteText+"</a></div>"):e.is("ul")||e.is("ol")?e.append('<li><a class="'+n.deleteCssClass+'" href="#">'+n.deleteText+"</a></li>"):e.children(":first").append('<span><a class="'+n.deleteCssClass+'" href="#">'+n.deleteText+"</a></span>"),e.find("a."+n.deleteCssClass).on("click",u.bind(this))},u=function(t){t.preventDefault();var s=e(t.target).closest("."+n.formCssClass);t=s.closest(".inline-group");var a=s.prev();let l;for(a.length&&a.hasClass("row-form-errors")&&a.remove(),s.remove(),--d,n.removed&&n.removed(s),e(document).trigger("formset:removed",[s,n.prefix]),s=e("."+n.formCssClass),e("#id_"+n.prefix+"-TOTAL_FORMS").val(s.length),(""===r.val()||0<r.val()-s.length)&&f.parent().show(),m(t),a=function(){i(this,n.prefix,l)},l=0,t=s.length;l<t;l++)i(e(s).get(l),n.prefix,l),e(s.get(l)).find("*").each(a)},m=function(e){""!==o.val()&&0<=o.val()-l.val()?e.find(".inline-deletelink").hide():e.find(".inline-deletelink").show()};return s.each((function(t){e(this).not("."+n.emptyCssClass).addClass(n.formCssClass)})),s.filter("."+n.formCssClass+":not(.has_original):not(."+n.emptyCssClass+")").each((function(){p(e(this))})),m(s),f=n.addButton,function(){if(null===f)if("TR"===s.prop("tagName")){const e=s.eq(-1).children().length;a.append('<tr class="'+n.addCssClass+'"><td colspan="'+e+'"><a href="#">'+n.addText+"</a></tr>"),f=a.find("tr:last a")}else s.filter(":last").after('<div class="'+n.addCssClass+'"><a href="#">'+n.addText+"</a></div>"),f=s.filter(":last").next().find("a");f.on("click",c)}(),t=""===r.val()||0<r.val()-l.val(),s.length&&t?f.parent().show():f.parent().hide(),this},e.fn.formset.defaults={prefix:"form",addText:"add another",deleteText:"remove",addCssClass:"add-row",deleteCssClass:"delete-row",emptyCssClass:"empty-row",formCssClass:"dynamic-form",added:null,removed:null,addButton:null},e.fn.tabularFormset=function(t,n){t=e(this);const s=function(){"undefined"!==typeof SelectFilter&&(e(".selectfilter").each((function(e,t){e=t.name.split("-"),SelectFilter.init(t.id,e[e.length-1],!1)})),e(".selectfilterstacked").each((function(e,t){e=t.name.split("-"),SelectFilter.init(t.id,e[e.length-1],!0)})))},a=function(t){t.find(".prepopulated_field").each((function(){const n=e(this).find("input, select, textarea"),s=n.data("dependency_list")||[],a=[];e.each(s,(function(e,n){a.push("#"+t.find(".field-"+n).find("input, select, textarea").attr("id"))})),a.length&&n.prepopulate(a,n.attr("maxlength"))}))};return t.formset({prefix:n.prefix,addText:n.addText,formCssClass:"dynamic-"+n.prefix,deleteCssClass:"inline-deletelink",deleteText:n.deleteText,emptyCssClass:"empty-form",added:function(t){a(t),"undefined"!==typeof DateTimeShortcuts&&(e(".datetimeshortcuts").remove(),DateTimeShortcuts.init()),s()},addButton:n.addButton}),t},e.fn.stackedFormset=function(t,n){const s=e(this),a=function(n){e(t).find(".inline_label").each((function(t){t+=1,e(this).html(e(this).html().replace(/(#\d+)/g,"#"+t))}))},i=function(){"undefined"!==typeof SelectFilter&&(e(".selectfilter").each((function(e,t){e=t.name.split("-"),SelectFilter.init(t.id,e[e.length-1],!1)})),e(".selectfilterstacked").each((function(e,t){e=t.name.split("-"),SelectFilter.init(t.id,e[e.length-1],!0)})))},l=function(t){t.find(".prepopulated_field").each((function(){const n=e(this).find("input, select, textarea"),s=n.data("dependency_list")||[],a=[];e.each(s,(function(e,n){a.push("#"+t.find(".form-row .field-"+n).find("input, select, textarea").attr("id"))})),a.length&&n.prepopulate(a,n.attr("maxlength"))}))};return s.formset({prefix:n.prefix,addText:n.addText,formCssClass:"dynamic-"+n.prefix,deleteCssClass:"inline-deletelink",deleteText:n.deleteText,emptyCssClass:"empty-form",removed:a,added:function(t){l(t),"undefined"!==typeof DateTimeShortcuts&&(e(".datetimeshortcuts").remove(),DateTimeShortcuts.init()),i(),a(t)},addButton:n.addButton}),s},e(document).ready((function(){e(".js-inline-admin-formset").each((function(){var t=e(this).data();const n=t.inlineFormset;switch(t.inlineType){case"stacked":t=n.name+"-group .inline-related",e(t).stackedFormset(t,n.options);break;case"tabular":t=n.name+"-group .tabular.inline-related tbody:first > tr.form-row",e(t).tabularFormset(t,n.options)}}))}))}